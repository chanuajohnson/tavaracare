
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>Tavara.care</title>
    <meta name="description" content="Trinidad and Tobago based care platform" />
    <meta name="author" content="Lovable" />
    <meta property="og:image" content="/og-image.png" />
    <link rel="icon" href="/favicon-new.ico" type="image/x-icon">
    <script>
      // Synchronously declare React in the global scope to prevent initialization issues
      window.React = window.React || {
        createElement: function() { return null; },
        forwardRef: function() { return null; },
        lazy: function() { return null; },
        useState: function() { return [null, function() {}]; },
        Suspense: function() { return null; }
      };
      window.reactInitialized = false; // Will be set to true once React is fully loaded
      
      console.log('[index.html] Setting initial React placeholder at:', new Date().toISOString());
      
      // Add a global error handler for initialization issues
      window.onerror = function(message, source, lineno, colno, error) {
        console.log('[index.html] Error handler triggered:', message);
        
        if ((message && message.includes('forwardRef')) || 
            (message && message.includes('createElement')) || 
            (message && message.includes('React'))) {
            
          console.error('[index.html] React initialization error detected:', message);
          console.error('[index.html] Error source:', source);
          console.error('[index.html] React available?', !!window.React);
          console.error('[index.html] React initialized?', !!window.reactInitialized);
          
          // Display fallback UI when React fails to initialize properly
          document.addEventListener('DOMContentLoaded', function() {
            var rootEl = document.getElementById('root');
            if (rootEl) {
              if (rootEl.children.length === 0 || !window.reactInitialized) {
                rootEl.innerHTML = '<div style="padding: 20px; color: #721c24; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; text-align: center;"><h3>Application is loading...</h3><p>If this message persists, please try refreshing the page.</p><pre style="text-align:left;background:#f8f8f8;padding:10px;font-size:12px;overflow:auto">Error: ' + message + '\nLocation: ' + source + ':' + lineno + '</pre><button onclick="window.location.reload()" style="background: #721c24; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-top: 10px; cursor: pointer;">Refresh Page</button></div>';
              }
            }
          });
          return true; // Prevents default error handling
        }
        return false; // Allow default error handling for other errors
      };
    </script>
  </head>

  <body>
    <div id="root">
      <!-- Initial loading state -->
      <div style="display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column;">
        <p style="margin-bottom: 16px; font-family: system-ui, sans-serif; color: #555">Loading Tavara.care application...</p>
        <div style="width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite;"></div>
      </div>
      <style>
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      </style>
    </div>
    <!-- Main application loading first with highest priority -->
    <script type="module" src="./src/main.tsx"></script>
    <!-- GPT Engineer script - for the Select feature -->
    <script type="module" src="https://cdn.gpteng.co/gptengineer.js"></script>
  </body>
</html>
